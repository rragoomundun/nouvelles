import{a as ae}from"./chunk-EIAFF7IL.js";import{b as L,c as J,d as k,e as w,f as V,g as O,h as N,j as $,k as H,q as D}from"./chunk-RD55HKQO.js";import{a as re}from"./chunk-HWW6DXAF.js";import{$a as ne,A as R,C as Q,Ca as te,Ea as p,F as A,Fa as y,G,Ga as m,La as U,Pa as d,Q as Z,Qa as l,T as r,W as f,X as h,Y as B,Ya as ie,ga as c,ha as u,hb as z,ib as v,jb as oe,la as _,ma as s,mb as C,na as a,nb as E,oa as S,pa as I,qa as b,ra as j,sa as F,ta as ee,ua as P,va as q,wa as x,z as K}from"./chunk-4DZUCNSY.js";var T=(()=>{let t=class t{constructor(o){this.http=o,this.API_PREFIX="user"}updateUserImage(o,i){let n=`${this.API_PREFIX}/${o}/image`;return this.http.put(n,i,{withCredentials:!0})}updatePassword(o,i){let n=`${this.API_PREFIX}/${o}/password`;return this.http.put(n,i,{withCredentials:!0})}updateBiography(o,i){let n=`${this.API_PREFIX}/${o}/biography`;return this.http.put(n,i,{withCredentials:!0})}deleteUser(o){let i=`${this.API_PREFIX}/${o}`;return this.http.delete(i,{withCredentials:!0})}};t.\u0275fac=function(i){return new(i||t)(Q(ne))},t.\u0275prov=K({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Se(e,t){if(e&1){let g=F();I(0,"span",7),q("click",function(){A(g);let i=x(2);return G(i.onDeleteImageClick())}),b()}}function ge(e,t){if(e&1&&(I(0,"div",1),j(1,"img",5),c(2,Se,1,0,"span",6),b()),e&2){let g=x();r(),ee("src",g.userSharedService.image,Z)("alt",g.userSharedService.name),r(),u(g.onImageChange!=="true"?2:-1)}}function he(e,t){e&1&&j(0,"span",2)}function ve(e,t){e&1&&(I(0,"button",4),p(1),d(2,"translate"),b()),e&2&&(r(),m(" ",l(2,1,"GENERAL.UPDATING")," "))}function Ce(e,t){if(e&1){let g=F();I(0,"label",8),p(1),d(2,"translate"),b(),I(3,"input",9),q("change",function(i){A(g);let n=x();return G(n.onFileSelected(i))}),b()}e&2&&(r(),m(" ",l(2,1,"SETTINGS_PAGE.CHANGE_IMAGE")," "))}var se=(()=>{let t=class t{constructor(o,i,n){this.userSharedService=o,this.fileSharedService=i,this.userService=n}ngOnInit(){this.onImageChange="false"}onDeleteImageClick(){this.userService.updateUserImage(this.userSharedService.id,{image:null}).subscribe({complete:()=>{this.userSharedService.image=null}})}onFileSelected(o){let i=o.target.files[0];if(this.onImageChange="true",this.userSharedService.image){let n={fileName:this.userSharedService.image?.split("/").slice(3).join("/")};this.fileSharedService.delete(n).subscribe()}this.fileSharedService.upload(i).subscribe({next:n=>{this.userService.updateUserImage(this.userSharedService.id,{image:n.file}).subscribe({complete:()=>{this.userSharedService.image=n.file,this.onImageChange="success"}})}})}};t.\u0275fac=function(i){return new(i||t)(f(v),f(ae),f(T))},t.\u0275cmp=h({type:t,selectors:[["app-settings-image"]],decls:12,vars:7,consts:[["id","image",1,"text-center"],[1,"text-end"],["id","user-icon",1,"fa-regular","fa-circle-user","fa-6x"],[1,"text-center"],["disabled","true",1,"btn","btn-outline-primary"],[3,"src","alt"],["id","delete-image",1,"fa-regular","fa-circle-xmark"],["id","delete-image",1,"fa-regular","fa-circle-xmark",3,"click"],["for","file",1,"btn","btn-outline-primary"],["id","file","type","file","autocomplete","off","required","","hidden","",3,"change"]],template:function(i,n){i&1&&(I(0,"form")(1,"fieldset")(2,"legend"),p(3),d(4,"translate"),b(),j(5,"hr"),I(6,"div",0),c(7,ge,3,3,"div",1)(8,he,1,0,"span",2),b(),I(9,"div",3),c(10,ve,3,3,"button",4)(11,Ce,4,3),b()()()),i&2&&(r(3),y(l(4,5,"SETTINGS_PAGE.PROFILE_IMAGE")),r(4),u(n.userSharedService.image?7:8),r(2),te("mt-3",!n.userSharedService.image),r(),u(n.onImageChange==="true"?10:11))},dependencies:[E,C],styles:["#image[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-of-type{display:inline-block;margin:0 auto}#image[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-of-type   img[_ngcontent-%COMP%]{display:block;width:128px;height:128px;border-radius:100%;border:1px solid #ccc}#image[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-of-type   span#delete-image[_ngcontent-%COMP%]{position:relative;top:-128px;right:0;font-size:1.25rem}#image[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-of-type   span#delete-image[_ngcontent-%COMP%]:hover{cursor:pointer}#image[_ngcontent-%COMP%]   span#user-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:128px;height:128px;margin:0 auto;border-radius:100%;border:1px solid #ccc;color:#333}"]});let e=t;return e})();var Ee=()=>["false","error","success"];function _e(e,t){if(e&1&&(s(0,"button",7),p(1),d(2,"translate"),a()),e&2){let g=x();_("disabled",g.passwordForm.valid===!1),r(),m(" ",l(2,2,"GENERAL.MODIFY")," ")}}function Ie(e,t){e&1&&(s(0,"button",8),S(1,"span",11),p(2),d(3,"translate"),a()),e&2&&(_("disabled",!0),r(2),m(" ",l(3,2,"GENERAL.MODIFICATION")," "))}function be(e,t){e&1&&(s(0,"p",9),p(1),d(2,"translate"),a()),e&2&&(r(),m(" ",l(2,1,"SETTINGS_PAGE.PASSWORD_MODIFIED")," "))}function xe(e,t){if(e&1&&(s(0,"p",10),p(1),d(2,"translate"),a()),e&2){let g=x();r(),m(" ",l(2,1,g.error)," ")}}var de=(()=>{let t=class t{constructor(o,i){this.userSharedService=o,this.userService=i}ngOnInit(){this.passwordForm=new V({password:new O("",[J.required]),repeatedPassword:new O("",[J.required])}),this.onModify="false"}onSubmit(){let o=this.passwordForm.value;this.onModify="true",this.userService.updatePassword(this.userSharedService.id,o).subscribe({next:()=>{this.onModify="success"},error:i=>{let{type:n}=i.error;this.onModify="error",n&&(this.error=`SETTINGS_PAGE.ERRORS.${n}`)}})}};t.\u0275fac=function(i){return new(i||t)(f(v),f(T))},t.\u0275cmp=h({type:t,selectors:[["app-settings-password"]],decls:23,vars:15,consts:[[3,"ngSubmit","formGroup"],[1,"mt-3"],["for","password",1,"form-label"],[1,"fa-solid","fa-lock"],["id","password","type","password","formControlName","password",1,"form-control"],["id","password","type","password","formControlName","repeatedPassword",1,"form-control"],[1,"mt-3","text-end"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"btn","btn-primary",3,"disabled"],[1,"text-success","mt-3"],[1,"text-danger","mt-3"],[1,"fa-solid","fa-spinner","fa-spin"]],template:function(i,n){i&1&&(s(0,"form",0),P("ngSubmit",function(){return n.onSubmit()}),s(1,"fieldset")(2,"legend"),p(3),d(4,"translate"),a(),S(5,"hr"),s(6,"div",1)(7,"label",2),S(8,"span",3),p(9),d(10,"translate"),a(),S(11,"input",4),a(),s(12,"div",1)(13,"label",2),S(14,"span",3),p(15),d(16,"translate"),a(),S(17,"input",5),a(),s(18,"div",6),c(19,_e,3,4,"button",7),c(20,Ie,4,4,"button",8),c(21,be,3,3,"p",9),c(22,xe,3,3,"p",10),a()()()),i&2&&(_("formGroup",n.passwordForm),r(3),y(l(4,8,"FORMS.PASSWORD")),r(6),m(" ",l(10,10,"FORMS.PASSWORD")," "),r(6),m(" ",l(16,12,"FORMS.REPEAT_PASSWORD")," "),r(4),u(U(14,Ee).includes(n.onModify)?19:-1),r(),u(n.onModify==="true"?20:-1),r(),u(n.onModify==="success"?21:-1),r(),u(n.onModify==="error"?22:-1))},dependencies:[E,D,N,L,k,w,$,H,C],encapsulation:2});let e=t;return e})();var ye=()=>["false","success"];function Te(e,t){e&1&&(s(0,"button",5),p(1),d(2,"translate"),a()),e&2&&(r(),m(" ",l(2,1,"GENERAL.MODIFY")," "))}function Me(e,t){e&1&&(s(0,"button",6),S(1,"span",8),p(2),d(3,"translate"),a()),e&2&&(_("disabled",!0),r(2),m(" ",l(3,2,"GENERAL.MODIFICATION")," "))}function Pe(e,t){e&1&&(s(0,"p",7),p(1),d(2,"translate"),a()),e&2&&(r(),m(" ",l(2,1,"SETTINGS_PAGE.BIOGRAPHY_MODIFIED")," "))}var le=(()=>{let t=class t{constructor(o,i){this.userSharedService=o,this.userService=i}ngOnInit(){this.biographyForm=new V({biography:new O(this.userSharedService.biography)}),this.onModify="false"}onSubmit(){let o=this.biographyForm.value;this.onModify="true",this.userService.updateBiography(this.userSharedService.id,o).subscribe({complete:()=>{this.onModify="success"}})}};t.\u0275fac=function(i){return new(i||t)(f(v),f(T))},t.\u0275cmp=h({type:t,selectors:[["app-settings-biography"]],decls:15,vars:11,consts:[[3,"ngSubmit","formGroup"],[1,"mt-3"],["for","biography",1,"form-label"],["id","biography","cols","30","rows","10","formControlName","biography",1,"form-control"],[1,"mt-3","text-end"],["type","submit",1,"btn","btn-primary"],[1,"btn","btn-primary",3,"disabled"],[1,"text-success","mt-3"],[1,"fa-solid","fa-spinner","fa-spin"]],template:function(i,n){i&1&&(s(0,"form",0),P("ngSubmit",function(){return n.onSubmit()}),s(1,"fieldset")(2,"legend"),p(3),d(4,"translate"),a(),S(5,"hr"),s(6,"div",1)(7,"label",2),p(8),d(9,"translate"),a(),S(10,"textarea",3),a(),s(11,"div",4),c(12,Te,3,3,"button",5),c(13,Me,4,4,"button",6),c(14,Pe,3,3,"p",7),a()()()),i&2&&(_("formGroup",n.biographyForm),r(3),y(l(4,6,"GENERAL.BIOGRAPHY")),r(5),y(l(9,8,"GENERAL.BIOGRAPHY")),r(4),u(U(10,ye).includes(n.onModify)?12:-1),r(),u(n.onModify==="true"?13:-1),r(),u(n.onModify==="success"?14:-1))},dependencies:[E,D,N,L,k,w,$,H,C],encapsulation:2});let e=t;return e})();function we(e,t){if(e&1){let g=F();s(0,"button",4),P("click",function(){A(g);let i=x();return G(i.onDeleteClick())}),p(1),d(2,"translate"),a()}e&2&&(r(),m(" ",l(2,1,"SETTINGS_PAGE.DELETE_ACCOUNT")," "))}function Ne(e,t){e&1&&(s(0,"button",3),p(1),d(2,"translate"),a()),e&2&&(_("disabled",!0),r(),m(" ",l(2,2,"GENERAL.DELETION")," "))}function De(e,t){e&1&&(s(0,"p"),p(1),d(2,"translate"),a()),e&2&&(r(),m(" ",l(2,1,"SETTINGS_PAGE.ACCOUNT_DELETED")," "))}var me=(()=>{let t=class t{constructor(o,i,n){this.authSharedService=o,this.userSharedService=i,this.userService=n}ngOnInit(){this.onDelete="false"}onDeleteClick(){this.onDelete="true",this.userService.deleteUser(this.userSharedService.id).subscribe({complete:()=>{this.onDelete="success",setTimeout(()=>this.authSharedService.doLogout(),3e3)}})}};t.\u0275fac=function(i){return new(i||t)(f(oe),f(v),f(T))},t.\u0275cmp=h({type:t,selectors:[["app-settings-delete"]],decls:13,vars:9,consts:[[1,"mt-3"],[1,"text-danger","fw-bold"],["type","button",1,"btn","btn-danger"],["type","button",1,"btn","btn-danger",3,"disabled"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(i,n){i&1&&(s(0,"form")(1,"fieldset")(2,"legend"),p(3),d(4,"translate"),a(),S(5,"hr"),s(6,"div",0)(7,"p",1),p(8),d(9,"translate"),a(),c(10,we,3,3,"button",2),c(11,Ne,3,4,"button",3),c(12,De,3,3,"p"),a()()()),i&2&&(r(3),m(" ",l(4,5,"SETTINGS_PAGE.DELETE_ACCOUNT")," "),r(5),m(" ",l(9,7,"SETTINGS_PAGE.DELETE_ACCOUNT_WARNING")," "),r(2),u(n.onDelete==="false"?10:-1),r(),u(n.onDelete==="true"?11:-1),r(),u(n.onDelete==="success"?12:-1))},dependencies:[E,D,N,w,C],encapsulation:2});let e=t;return e})();function Ae(e,t){e&1&&(s(0,"div",0)(1,"h2",1),p(2),d(3,"translate"),a(),S(4,"app-settings-image")(5,"app-settings-password")(6,"app-settings-biography")(7,"app-settings-delete"),a()),e&2&&(r(2),y(l(3,1,"HEADER.ACCOUNT.SETTINGS")))}var ce=(()=>{let t=class t{constructor(o,i){this.userSharedService=o,this.appSharedService=i}ngOnInit(){this.appSharedService.setTitle("HEADER.ACCOUNT.SETTINGS")}};t.\u0275fac=function(i){return new(i||t)(f(v),f(re))},t.\u0275cmp=h({type:t,selectors:[["app-settings"]],decls:1,vars:1,consts:[[1,"container"],[1,"title"]],template:function(i,n){i&1&&c(0,Ae,8,3,"div",0),i&2&&u(n.userSharedService.id?0:-1)},dependencies:[E,se,de,le,me,C],encapsulation:2});let e=t;return e})();var Ge=[{path:"",component:ce}],ue=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=B({type:t}),t.\u0275inj=R({imports:[z.forChild(Ge),z]});let e=t;return e})();var at=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=B({type:t}),t.\u0275inj=R({imports:[ie,ue]});let e=t;return e})();export{at as SettingsModule};
