import './polyfills.server.mjs';
import{a as te}from"./chunk-GHONRAMF.mjs";import{a as Q}from"./chunk-KCZYROFR.mjs";import{a as B,b as P,c as I,d as k,e as q,f as M,g as S,h as j,j as W,k as U,l as $,m as H,n as Y,o as z,p as J,q as K}from"./chunk-TUEDPJ5W.mjs";import{a as ee,b as se}from"./chunk-U7D5EGXH.mjs";import{a as X}from"./chunk-KXZ5GERM.mjs";import{a as Z}from"./chunk-O42ZTD4W.mjs";import{$ as f,Ba as le,C as ne,D as re,Da as g,Fa as x,Lb as de,Na as l,Oa as C,Pa as u,Pb as V,Qb as b,Ra as T,Sb as O,Tb as D,Ua as w,V as ae,Y as i,Ya as d,Za as s,ba as y,ca as R,pa as h,qa as v,ra as L,sa as F,ta as G,ua as E,v as N,va as r,wa as n,wb as ce,xa as _}from"./chunk-NJKZRZTJ.mjs";import"./chunk-S6KH3LOX.mjs";var Ae=()=>["false","success","error"];function be(e,t){if(e&1&&(r(0,"option",9),l(1),n()),e&2){let c=t.$implicit;E("value",T(c.label)),i(),C(c.name)}}function ge(e,t){if(e&1&&(r(0,"button",16),l(1),d(2,"translate"),n()),e&2){let c=x();E("disabled",c.isFormValid===!1),i(),u(" ",s(2,2,"GENERAL.CREATE")," ")}}function Te(e,t){e&1&&(r(0,"button",16),_(1,"span",19),l(2),d(3,"translate"),n()),e&2&&(E("disabled",!0),i(2),u(" ",s(3,2,"GENERAL.CREATION")," "))}function Ne(e,t){if(e&1&&(r(0,"div",17)(1,"span"),l(2),d(3,"translate"),n(),r(4,"a",20),l(5),n()()),e&2){let c=x();i(2),C(s(3,4,"NEW_ARTICLE_PAGE.CREATED")),i(2),E("routerLink",T(c.createdArticleLink)),i(),u(" ",c.title," ")}}function ye(e,t){e&1&&(r(0,"div",18)(1,"span"),l(2),d(3,"translate"),n()()),e&2&&(i(2),C(s(3,1,"NEW_ARTICLE_PAGE.ERRORS.CREATION")))}var pe=(()=>{let t=class t{constructor(a,o,p,A,m){this.appSharedService=a,this.articleSharedService=o,this.fileSharedService=p,this.urlSharedService=A,this.categorySharedService=m}get isFormValid(){return this.articleForm.controls.title.status==="VALID"&&this.articleForm.controls.content.status==="VALID"&&this.articleForm.controls.category.status==="VALID"&&this.file!==void 0}ngOnInit(){this.appSharedService.setTitle("NEW_ARTICLE_PAGE.TITLE"),this.articleForm=new M({title:new S("",[I.required]),image:new S("",[I.required]),content:new S("",[I.required]),category:new S(null,[I.required]),published:new S(!1)}),this.onCreation="false"}onFileSelected(a){this.file=a.target.files[0]}onSubmit(){let a=this.articleForm.controls.published,o;[!0,"true"].includes(a.value)&&(o="true"),a.setValue(o),this.title=this.articleForm.controls.title.value,this.onCreation="true",this.fileSharedService.upload(this.file).subscribe({next:p=>{this.articleForm.controls.image.setValue(p.file),this.articleSharedService.postArticle(this.articleForm.value).subscribe({next:A=>{this.createdArticleLink=`/categorie/${this.articleForm.controls.category.value}/article/${A.id}/${this.urlSharedService.toLowerURL(this.articleForm.controls.title.value)}`},complete:()=>{this.onCreation="success"},error:()=>{this.onCreation="error"}})},error:()=>{this.onCreation="error"}})}};t.\u0275fac=function(o){return new(o||t)(f(Z),f(ee),f(te),f(X),f(Q))},t.\u0275cmp=y({type:t,selectors:[["app-new-article"]],decls:37,vars:24,consts:[[1,"title"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","title",1,"form-label"],["id","title","type","text","formControlName","title","required","",1,"form-control"],["for","file",1,"form-label"],["id","file","type","file","autocomplete","off","required","",1,"form-control",3,"change"],["for","category",1,"form-label"],["id","category","formControlName","category","required","",1,"form-select"],[3,"value"],[1,"form-check"],["id","publish","type","checkbox","value","","formControlName","published","required","",1,"form-check-input"],["for","publish",1,"form-check-label"],["for","content",1,"form-label"],["id","content","cols","30","rows","10","formControlName","content","required","",1,"form-control"],[1,"text-end"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"text-end","text-success","mt-3"],[1,"text-end","text-danger","mt-3"],[1,"fa-solid","fa-spinner","fa-spin"],[3,"routerLink"]],template:function(o,p){o&1&&(r(0,"h2",0),l(1),d(2,"translate"),n(),r(3,"form",1),g("ngSubmit",function(){return p.onSubmit()}),r(4,"div",2)(5,"label",3),l(6),d(7,"translate"),n(),_(8,"input",4),n(),r(9,"div",2)(10,"label",5),l(11),d(12,"translate"),n(),r(13,"input",6),g("change",function(m){return p.onFileSelected(m)}),n()(),r(14,"div",2)(15,"label",7),l(16),d(17,"translate"),n(),r(18,"select",8),F(19,be,2,3,"option",9,L),n()(),r(21,"div",2)(22,"div",10),_(23,"input",11),r(24,"label",12),l(25),d(26,"translate"),n()()(),r(27,"div",2)(28,"label",13),l(29),d(30,"translate"),n(),_(31,"textarea",14),n(),r(32,"div",15),h(33,ge,3,4,"button",16),h(34,Te,4,4,"button",16),n(),h(35,Ne,6,6,"div",17),h(36,ye,4,3,"div",18),n()),o&2&&(i(),C(s(2,11,"NEW_ARTICLE_PAGE.TITLE")),i(2),E("formGroup",p.articleForm),i(3),u(" ",s(7,13,"NEW_ARTICLE_PAGE.ARTICLE_TITLE")," "),i(5),u(" ",s(12,15,"NEW_ARTICLE_PAGE.IMAGE")," "),i(5),u(" ",s(17,17,"GENERAL.CATEGORY")," "),i(3),G(p.categorySharedService.categories),i(6),u(" ",s(26,19,"NEW_ARTICLE_PAGE.PUBLISH")," "),i(4),u(" ",s(30,21,"NEW_ARTICLE_PAGE.CONTENT")," "),i(4),v(w(23,Ae).includes(p.onCreation)?33:-1),i(),v(p.onCreation==="true"?34:-1),i(),v(p.onCreation==="success"?35:-1),i(),v(p.onCreation==="error"?36:-1))},dependencies:[D,K,j,H,Y,P,B,$,k,q,z,J,W,U,b,V,O],encapsulation:2});let e=t;return e})();var Re=()=>["false","success","error"];function Le(e,t){e&1&&(r(0,"div",0)(1,"h2"),l(2),d(3,"translate"),n()()),e&2&&(i(2),C(s(3,1,"EDIT_ARTICLE_PAGE.ERRORS.NOT_FOUND")))}function Fe(e,t){e&1&&(r(0,"div",0)(1,"h2"),l(2),d(3,"translate"),n()()),e&2&&(i(2),C(s(3,1,"EDIT_ARTICLE_PAGE.ERRORS.NOT_OWNER")))}function Ge(e,t){if(e&1&&(r(0,"div",8)(1,"label",22),l(2),d(3,"translate"),n(),_(4,"br")(5,"img",23),n()),e&2){let c=x(2);i(2),u(" ",s(3,2,"EDIT_ARTICLE_PAGE.IMAGE_USE")," "),i(3),E("src",c.image,ae)}}function we(e,t){if(e&1&&(r(0,"option",11),l(1),n()),e&2){let c=t.$implicit;E("value",T(c.label)),i(),C(c.name)}}function Ve(e,t){if(e&1&&(r(0,"button",18),l(1),d(2,"translate"),n()),e&2){let c=x(2);E("disabled",c.isFormValid===!1),i(),u(" ",s(2,2,"EDIT_ARTICLE_PAGE.EDIT")," ")}}function Oe(e,t){e&1&&(r(0,"button",19),_(1,"span",24),l(2),d(3,"translate"),n()),e&2&&(E("disabled",!0),i(2),u(" ",s(3,2,"EDIT_ARTICLE_PAGE.EDITION")," "))}function De(e,t){if(e&1&&(r(0,"div",20)(1,"span"),l(2),d(3,"translate"),n(),r(4,"a",25),l(5),n()()),e&2){let c=x(2);i(2),C(s(3,4,"EDIT_ARTICLE_PAGE.EDITED")),i(2),E("routerLink",T(c.editedArticleLink)),i(),u(" ",c.title," ")}}function Be(e,t){e&1&&(r(0,"div",21)(1,"span"),l(2),d(3,"translate"),n()()),e&2&&(i(2),C(s(3,1,"EDIT_ARTICLE_PAGE.ERRORS.EDITION")))}function Pe(e,t){if(e&1){let c=le();r(0,"h2",1),l(1),d(2,"translate"),n(),r(3,"form",2),g("ngSubmit",function(){ne(c);let o=x();return re(o.onSubmit())}),r(4,"div",3)(5,"label",4),l(6),d(7,"translate"),n(),_(8,"input",5),n(),r(9,"div",3)(10,"label",6),l(11),d(12,"translate"),n(),r(13,"input",7),g("change",function(o){ne(c);let p=x();return re(p.onFileSelected(o))}),n(),h(14,Ge,6,4,"div",8),n(),r(15,"div",3)(16,"label",9),l(17),d(18,"translate"),n(),r(19,"select",10),F(20,we,2,3,"option",11,L),n()(),r(22,"div",3)(23,"div",12),_(24,"input",13),r(25,"label",14),l(26),d(27,"translate"),n()()(),r(28,"div",3)(29,"label",15),l(30),d(31,"translate"),n(),_(32,"textarea",16),n(),r(33,"div",17),h(34,Ve,3,4,"button",18),h(35,Oe,4,4,"button",19),n(),h(36,De,6,6,"div",20),h(37,Be,4,3,"div",21),n()}if(e&2){let c=x();i(),C(s(2,12,"EDIT_ARTICLE_PAGE.TITLE")),i(2),E("formGroup",c.articleForm),i(3),u(" ",s(7,14,"NEW_ARTICLE_PAGE.ARTICLE_TITLE")," "),i(5),u(" ",s(12,16,"NEW_ARTICLE_PAGE.IMAGE")," "),i(3),v(c.image?14:-1),i(3),u(" ",s(18,18,"GENERAL.CATEGORY")," "),i(3),G(c.categorySharedService.categories),i(6),u(" ",s(27,20,"NEW_ARTICLE_PAGE.PUBLISH")," "),i(4),u(" ",s(31,22,"NEW_ARTICLE_PAGE.CONTENT")," "),i(4),v(w(24,Re).includes(c.onEdit)?34:-1),i(),v(c.onEdit==="true"?35:-1),i(),v(c.onEdit==="success"?36:-1),i(),v(c.onEdit==="error"?37:-1)}}var me=(()=>{let t=class t{constructor(a,o,p,A,m,ie,fe){this.activatedRoute=a,this.appSharedService=o,this.articleSharedService=p,this.articleService=A,this.fileSharedService=m,this.urlSharedService=ie,this.categorySharedService=fe}get isFormValid(){return this.articleForm.controls.title.status==="VALID"&&this.articleForm.controls.content.status==="VALID"&&this.articleForm.controls.category.status==="VALID"&&(this.file!==void 0||this.image!==null)}ngOnInit(){this.appSharedService.setTitle("EDIT_ARTICLE_PAGE.TITLE"),this.id=this.activatedRoute.snapshot.params.id,this.articleForm=new M({title:new S("",[I.required]),image:new S("",[I.required]),content:new S("",[I.required]),category:new S(null,[I.required]),published:new S(!1)}),this.onEdit="false",this.articleService.isUserOwner(this.id).subscribe({next:()=>{this.articleSharedService.getArticle(this.id).subscribe({next:a=>{this.image=a.image,this.articleForm.controls.title.setValue(a.title),this.articleForm.controls.content.setValue(a.content),this.articleForm.controls.category.setValue(a.category),this.articleForm.controls.published.setValue(!!a.published)}})},error:a=>{let{type:o}=a.error;o&&(o==="NOT_OWNER"?this.isNotOwner=!0:o==="NOT_FOUND"&&(this.notFound=!0))}})}onFileSelected(a){this.file=a.target.files[0],this.image=null}onSubmit(){let{title:a,content:o,category:p,published:A}=this.articleForm.controls,m={id:this.id,title:a.value,content:o.value,category:p.value};this.title=a.value,[!0,"true"].includes(A.value)?m.published="true":m.published=null,this.onEdit="true",this.image?(m.image=this.image,this.articleSharedService.postArticle(m).subscribe({complete:()=>{this.editedArticleLink=`/categorie/${m.category}/article/${m.id}/${this.urlSharedService.toLowerURL(m.title)}`,this.onEdit="success"},error:()=>{this.onEdit="error"}})):this.fileSharedService.upload(this.file).subscribe({next:ie=>{m.image=ie.file,this.articleSharedService.postArticle(m).subscribe({complete:()=>{this.editedArticleLink=`/categorie/${m.category}/article/${m.id}/${this.urlSharedService.toLowerURL(m.title)}`,this.image=m.image,this.file=null,this.onEdit="success"},error:()=>{this.onEdit="error"}})},error:()=>{this.onEdit="error"}})}};t.\u0275fac=function(o){return new(o||t)(f(de),f(Z),f(ee),f(se),f(te),f(X),f(Q))},t.\u0275cmp=y({type:t,selectors:[["app-edit-article"]],decls:3,vars:1,consts:[["id","error-edit"],[1,"title"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","title",1,"form-label"],["id","title","type","text","formControlName","title","required","",1,"form-control"],["for","file",1,"form-label"],["id","file","type","file","autocomplete","off","required","",1,"form-control",3,"change"],["id","original-image",1,"mt-1"],["for","category",1,"form-label"],["id","category","formControlName","category","required","",1,"form-select"],[3,"value"],[1,"form-check"],["id","publish","type","checkbox","value","","formControlName","published","required","",1,"form-check-input"],["for","publish",1,"form-check-label"],["for","content",1,"form-label"],["id","content","cols","30","rows","10","formControlName","content","required","",1,"form-control"],[1,"text-end"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"btn","btn-primary",3,"disabled"],[1,"text-end","text-success","mt-3"],[1,"text-end","text-danger","mt-3"],[1,"form-label"],[3,"src"],[1,"fa-solid","fa-spinner","fa-spin"],[3,"routerLink"]],template:function(o,p){o&1&&h(0,Le,4,3,"div",0)(1,Fe,4,3,"div",0)(2,Pe,38,25),o&2&&v(p.notFound?0:p.isNotOwner?1:2)},dependencies:[D,b,V,K,j,H,Y,P,B,$,k,q,z,J,W,U,O],styles:["#error-edit[_ngcontent-%COMP%]{text-align:center}#original-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px}"]});let e=t;return e})();var ke=[{path:"nouveau",component:pe},{path:":id/editer",component:me}],ue=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=R({type:t}),t.\u0275inj=N({imports:[b.forChild(ke),b]});let e=t;return e})();var tt=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=R({type:t}),t.\u0275inj=N({imports:[ce,ue]});let e=t;return e})();export{tt as ArticleModule};
