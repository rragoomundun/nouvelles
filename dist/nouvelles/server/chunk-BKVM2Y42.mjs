import './polyfills.server.mjs';
import{a as ve}from"./chunk-YODHHD7H.mjs";import{b as se,c as H}from"./chunk-IT6WC5OU.mjs";import{b as Q,d as W,e as Z,f as ee,g as B,h as te,i as ie,j as re,k as ne,q as ae}from"./chunk-6UJJCHF4.mjs";import{a as N}from"./chunk-MIUP32TR.mjs";import{a as oe}from"./chunk-VJ4G76S4.mjs";import{$ as m,Da as R,Fa as S,Gb as J,Lb as I,Na as p,Oa as d,Ob as K,P as M,Pa as y,Pb as w,Qb as _,Sb as b,Tb as E,V as $,Va as z,X as V,Xa as F,Y as a,Ya as h,Za as f,ba as g,ca as T,pa as v,qa as C,ra as q,sa as x,ta as D,u as X,ua as l,v as P,va as o,wa as s,wb as Y,x as U,xa as u,zb as O}from"./chunk-JFKNGTIP.mjs";import{f as Se}from"./chunk-S6KH3LOX.mjs";var ye=(t,e,c)=>["/categorie",t,"article",e,c],ce=(()=>{let e=class e{constructor(i){this.urlSharedService=i}};e.\u0275fac=function(r){return new(r||e)(m(N))},e.\u0275cmp=g({type:e,selectors:[["app-search-articles-item"]],inputs:{article:"article"},decls:4,vars:8,consts:[[1,"title-link",3,"routerLink"],[1,"image-ratio-16x9",3,"src","alt"]],template:function(r,n){r&1&&(o(0,"a",0),u(1,"img",1),o(2,"h5"),p(3),s()()),r&2&&(l("routerLink",F(4,ye,n.article.category,n.article.id,n.urlSharedService.toLowerURL(n.article.title))),a(),l("src",n.article.image,$)("alt",n.article.title),a(2),d(n.article.title))},dependencies:[_,w],styles:["img[_ngcontent-%COMP%]{width:100%}"]});let t=e;return t})();var L=(()=>{let e=class e{constructor(i){this.http=i,this.API_PREFIX="search"}searchArticles(i){return this.http.get(`${this.API_PREFIX}/articles`,{params:i})}searchArticlesMeta(i){return this.http.get(`${this.API_PREFIX}/articles/meta`,{params:i})}searchDiscussions(i){return this.http.get(`${this.API_PREFIX}/discussions`,{params:i})}searchDiscussionsMeta(i){return this.http.get(`${this.API_PREFIX}/discussions/meta`,{params:i})}};e.\u0275fac=function(r){return new(r||e)(U(J))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function _e(t,e){if(t&1&&(o(0,"div",1),u(1,"app-search-articles-item",2),s()),t&2){let c=e.$implicit;a(),l("article",c)}}function Ae(t,e){if(t&1&&(o(0,"div",0),x(1,_e,2,1,"div",1,q),s()),t&2){let c=S();a(),D(c.articles)}}function Ie(t,e){t&1&&(o(0,"p"),p(1),h(2,"translate"),s()),t&2&&(a(),d(f(2,1,"SEARCH_PAGE.ERRORS.NO_ARTICLES")))}function be(t,e){t&1&&(o(0,"p"),p(1),h(2,"translate"),s()),t&2&&(a(),d(f(2,1,"SEARCH_PAGE.ERRORS.NO_ARTICLES_NO_SEARCH")))}function Ee(t,e){if(t&1&&u(0,"br")(1,"app-pagination",3),t&2){let c=S();a(),l("nbPages",c.nbPages)}}var le=(()=>{let e=class e{constructor(i,r,n){this.activatedRoute=i,this.searchService=r,this.platformId=n}get page(){return Number(this.activatedRoute.snapshot.queryParams.page||"1")}ngOnInit(){this.getMetaInformation(),this.getArticles(),this.queryParamsSubscription=this.activatedRoute.queryParams.subscribe({next:()=>{this.getMetaInformation(),this.getArticles()}})}ngOnDestroy(){this.queryParamsSubscription.unsubscribe()}getArticles(){let i={query:this.query,page:this.page};this.searchService.searchArticles(i).subscribe({next:r=>{this.articles=r,O(this.platformId)&&setTimeout(()=>window.scrollTo({top:0,behavior:"instant"}))}})}getMetaInformation(){let i={query:this.query};this.searchService.searchArticlesMeta(i).subscribe({next:r=>{this.nbPages=r.nbPages}})}};e.\u0275fac=function(r){return new(r||e)(m(I),m(L),m(M))},e.\u0275cmp=g({type:e,selectors:[["app-search-articles"]],inputs:{query:"query"},decls:4,vars:2,consts:[[1,"row"],[1,"col-12","col-sm-6"],[3,"article"],[3,"nbPages"]],template:function(r,n){r&1&&(v(0,Ae,3,0,"div",0)(1,Ie,3,3,"p")(2,be,3,3,"p"),v(3,Ee,2,1)),r&2&&(C(n.articles&&n.articles.length?0:n.articles!==void 0?1:n.query?-1:2),a(3),C(n.nbPages?3:-1))},dependencies:[E,ce,H,b],encapsulation:2});let t=e;return t})();var ue=Se(ve());var Re=(t,e,c)=>["/forum",t,"discussion",e,c],Pe=t=>({page:t}),de=(()=>{let e=class e{constructor(i,r){this.urlSharedService=i,this.dateSharedService=r,this.MAX_MESSAGE_CHARACTERS=200}ngOnInit(){this.message.content=(0,ue.default)(this.message.content),this.message.content.length>this.MAX_MESSAGE_CHARACTERS&&(this.message.content=this.message.content.substring(0,this.MAX_MESSAGE_CHARACTERS-3)+"...");let i=new Date(this.message.date);this.message.dateFormatted=this.dateSharedService.dt.set({day:i.getDate(),month:i.getMonth()+1,year:i.getFullYear(),hour:i.getHours(),minute:i.getMinutes()}).toFormat("dd/LL/yyyy, HH:mm")}};e.\u0275fac=function(r){return new(r||e)(m(N),m(se))},e.\u0275cmp=g({type:e,selectors:[["app-search-discussions-item"]],inputs:{message:"message"},decls:7,vars:12,consts:[[3,"routerLink","queryParams","fragment"]],template:function(r,n){r&1&&(o(0,"div")(1,"a",0),p(2),s(),o(3,"p"),p(4),s(),o(5,"span"),p(6),s()()),r&2&&(a(),l("routerLink",F(6,Re,n.message.forum.label,n.message.discussion.id,n.urlSharedService.toLowerURL(n.message.discussion.name)))("queryParams",z(10,Pe,n.message.discussion.page))("fragment","message-"+n.message.id),a(),y(" ",n.message.discussion.name," "),a(2),d(n.message.content),a(2),d(n.message.dateFormatted))},dependencies:[_,w],encapsulation:2});let t=e;return t})();function Me(t,e){if(t&1&&(o(0,"div",0)(1,"div",1),u(2,"app-search-discussions-item",2),s()(),u(3,"hr")),t&2){let c=e.$implicit;a(2),l("message",c)}}function Te(t,e){if(t&1&&x(0,Me,4,1,null,null,q),t&2){let c=S();D(c.messages)}}function qe(t,e){t&1&&(o(0,"p"),p(1),h(2,"translate"),s()),t&2&&(a(),d(f(2,1,"SEARCH_PAGE.ERRORS.NO_MESSAGES")))}function xe(t,e){t&1&&(o(0,"p"),p(1),h(2,"translate"),s()),t&2&&(a(),d(f(2,1,"SEARCH_PAGE.ERRORS.NO_MESSAGES_NO_SEARCH")))}function De(t,e){if(t&1&&u(0,"br")(1,"app-pagination",3),t&2){let c=S();a(),l("nbPages",c.nbPages)}}var he=(()=>{let e=class e{constructor(i,r,n){this.activatedRoute=i,this.searchService=r,this.platformId=n}get page(){return Number(this.activatedRoute.snapshot.queryParams.page||"1")}ngOnInit(){this.getMetaInformation(),this.getDiscussions(),this.queryParamsSubscription=this.activatedRoute.queryParams.subscribe({next:()=>{this.getMetaInformation(),this.getDiscussions()}})}ngOnDestroy(){this.queryParamsSubscription.unsubscribe()}getDiscussions(){let i={query:this.query,page:this.page};this.searchService.searchDiscussions(i).subscribe({next:r=>{this.messages=r,O(this.platformId)&&setTimeout(()=>window.scrollTo({top:0,behavior:"instant"}))}})}getMetaInformation(){let i={query:this.query};this.searchService.searchDiscussionsMeta(i).subscribe({next:r=>{this.nbPages=r.nbPages}})}};e.\u0275fac=function(r){return new(r||e)(m(I),m(L),m(M))},e.\u0275cmp=g({type:e,selectors:[["app-search-discussions"]],inputs:{query:"query"},decls:4,vars:2,consts:[[1,"row"],[1,"col"],[3,"message"],[3,"nbPages"]],template:function(r,n){r&1&&(v(0,Te,2,0)(1,qe,3,3,"p")(2,xe,3,3,"p"),v(3,De,2,1)),r&2&&(C(n.messages&&n.messages.length?0:n.messages!==void 0?1:n.query?-1:2),a(3),C(n.nbPages?3:-1))},dependencies:[E,de,H,b],encapsulation:2});let t=e;return t})();function Fe(t,e){if(t&1&&u(0,"app-search-articles",15),t&2){let c=S();l("query",c.queryControl)}}function Oe(t,e){if(t&1&&u(0,"app-search-discussions",15),t&2){let c=S();l("query",c.queryControl)}}var fe=(()=>{let e=class e{constructor(i,r,n){this.activatedRoute=i,this.router=r,this.appService=n}get query(){return this.activatedRoute.snapshot.queryParams.query}get queryControl(){return this.searchForm.controls.query.value}get searchArea(){let i=this.activatedRoute.snapshot.queryParams.searchArea;return!i||["articles","forum"].includes(i)===!1?"articles":i}get searchAreaControl(){return this.searchForm.controls.searchArea.value}ngOnInit(){this.searchForm=new ee({query:new B(this.query),searchArea:new B(this.searchArea)}),this.appService.setTitle("SEARCH_PAGE.TITLE")}load(){this.router.navigate(["/rechercher"],{queryParams:{query:this.queryControl,searchArea:this.searchAreaControl}})}onSubmit(i){i.preventDefault(),this.load()}onSearchAreaChange(){this.load()}onHeaderSearch(i){this.searchForm.controls.query.setValue(i.detail.query),setTimeout(()=>this.load())}};e.\u0275fac=function(r){return new(r||e)(m(I),m(K),m(oe))},e.\u0275cmp=g({type:e,selectors:[["app-search"]],hostBindings:function(r,n){r&1&&R("headerSearch",function(k){return n.onHeaderSearch(k)},V)},decls:27,vars:14,consts:[[1,"container"],[3,"submit","formGroup"],[1,"mt-3"],["for","search",1,"form-label"],["id","search-bar",1,"input-group"],["type","text","formControlName","query",1,"form-control"],[1,"btn"],[1,"fa-solid","fa-magnifying-glass"],["id","search-area",1,"mt-3"],[1,"form-label"],[1,"form-check"],["id","search-area-1","name","searchArea","type","radio","value","articles","formControlName","searchArea",1,"form-check-input",3,"change"],["for","search-area-1",1,"form-check-label"],["id","search-area-2","name","searchArea","type","radio","value","forum","formControlName","searchArea",1,"form-check-input",3,"change"],["for","search-area-2",1,"form-check-label"],[3,"query"]],template:function(r,n){r&1&&(o(0,"div",0)(1,"form",1),R("submit",function(k){return n.onSubmit(k)}),o(2,"div",2)(3,"label",3),p(4),h(5,"translate"),s(),o(6,"div",4),u(7,"input",5),o(8,"button",6),u(9,"span",7),s()()(),o(10,"div",8)(11,"label",9),p(12),h(13,"translate"),s(),o(14,"div",10)(15,"input",11),R("change",function(){return n.onSearchAreaChange()}),s(),o(16,"label",12),p(17),h(18,"translate"),s()(),o(19,"div",10)(20,"input",13),R("change",function(){return n.onSearchAreaChange()}),s(),o(21,"label",14),p(22),h(23,"translate"),s()()()(),u(24,"hr"),v(25,Fe,1,1,"app-search-articles",15)(26,Oe,1,1,"app-search-discussions",15),s()),r&2&&(a(),l("formGroup",n.searchForm),a(3),y(" ",f(5,6,"GENERAL.SEARCH")," "),a(8),y(" ",f(13,8,"SEARCH_PAGE.SEARCH_IN")," : "),a(5),y(" ",f(18,10,"GENERAL.ARTICLES")," "),a(5),y(" ",f(23,12,"GENERAL.FORUM")," "),a(3),C(n.searchAreaControl==="articles"?25:26))},dependencies:[E,ae,te,Q,ie,W,Z,re,ne,le,he,b],styles:["#search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-right:none}#search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:var(--bs-border-width) solid var(--bs-border-color);border-left:none}#search-area[_ngcontent-%COMP%]{display:flex}#search-area[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]{margin-left:.5rem}"]});let t=e;return t})();var we=[{path:"",component:fe}],ge=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=T({type:e}),e.\u0275inj=P({imports:[_.forChild(we),_]});let t=e;return t})();var vt=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=T({type:e}),e.\u0275inj=P({imports:[Y,ge]});let t=e;return t})();export{vt as SearchModule};
